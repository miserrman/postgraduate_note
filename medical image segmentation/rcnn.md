# RCNN

基于深度学习的行人检测典型代表有RCNN系列，YOLO系列和SSD系列。

目标检测：准确给定图像中对象的位置，并标出图像的类别

（1）候选区域选择

（2）CNN特征提取

（3）分类与边界回归

## 候选区域的选择

区域建议Region Proposal是一种传统的区域提取方法，基于启发式的区域提取方法，用的方法是ss，查看现有的小区域，合并两个最有可能的区域，重复此步骤，直到图像合并为一个区域，最后输出候选区域。然后将根据建议提取的目标图像标准化，作为CNN的标准输入可以看作窗口通过滑动获得潜在的目标图像，在RCNN中一般Candidate选项为1k~2k个即可，即可理解为将图片划分成1k~2k个网格，之后再对网格进行特征提取或卷积操作，这根据RCNN类算法下的分支来决定。然后基于就建议提取的目标图像将其标准化为CNN的标准输入。

So, RPN网络做的事情就是，把一张图片中，我不感兴趣的区域——花花草草、大马路、天空之类的区域忽视掉，只留下一些我可能感兴趣的区域——车辆、行人、水杯、闹钟等等，然后我之后只需要关注这些感兴趣的区域，进一步确定它到底是车辆、还是行人、还是水杯（分类问题）。。。。

你可能会看到另一对通俗易懂的词语，**前景（车、人、杯）**和**背景（大马路、天空）**。

![img](https://pic1.zhimg.com/50/v2-c83e51140ccc24f6f32d2205eb2536e7_720w.jpg?source=1940ef5c)![img](https://pic1.zhimg.com/80/v2-c83e51140ccc24f6f32d2205eb2536e7_1440w.jpg?source=1940ef5c)

1、Input Image经过CNN特征提取，**首先**来到Region Proposal网络。由Regio Proposal Network输出的Classification，这**并不是**判定物体在COCO数据集上对应的80类中哪一类，而是输出一个Binary的值p，可以理解为 ![[公式]](https://www.zhihu.com/equation?tex=p%5Cin%5B0%2C1%5D) ，人工设定一个threshold=0.5。

RPN网络做的事情就是，如果一个Region的 ![[公式]](https://www.zhihu.com/equation?tex=p%5Cgeq0.5) ，则认为这个Region中可能是80个类别中的某一类，具体是哪一类现在还不清楚。到此为止，Network只需要把这些可能含有物体的区域选取出来就可以了，这些被选取出来的Region又叫做ROI （Region of Interests)，即感兴趣的区域。当然了，**RPN同时也会在feature map上框定这些ROI感兴趣区域的大致位置，即输出Bounding-box**。



## CNN特征提取

标准卷积神经网络根据输入执行诸如卷积或池化的操作以获得固定维度输出。也就是说，在特征提取之后，特征映射被卷积和汇集以获得输出。

## 分类与边界回归

实际上有两个子步骤，一个是对前一步的输出向量进行分类（分类器需要根据特征进行训练）; 第二种是通过边界回归框回归（缩写为bbox）获得精确的区域信息。其目的是准确定位和合并完成分类的预期目标，并避免多重检测。在分类器的选择中有支持向量机SVM，Softmax等等；边界回归有bbox回归，多任务损失函数边框回归等 。